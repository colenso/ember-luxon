{"version":3,"file":"-base.js","sources":["../../src/helpers/-base.js"],"sourcesContent":["import { run } from '@ember/runloop';\nimport Helper from '@ember/component/helper';\nimport { observer } from '@ember/object';\nimport { inject as service } from '@ember/service';\nimport { tracked } from '@glimmer/tracking';\n\n// eslint-disable-next-line ember/no-classic-classes\nexport default class BaseHelper extends Helper {\n  @service luxon;\n\n  @tracked disableInterval = false;\n\n  @tracked supportsGlobalAllowEmpty = true;\n\n  get globalAllowEmpty() {\n    return this.luxon.__config__.allowEmpty;\n  }\n\n  // eslint-disable-next-line ember/no-observers\n  localeOrTimeZoneChanged = observer(\n    'luxon.locale',\n    'luxon.timeZone',\n    function () {\n      this.recompute();\n    },\n  );\n\n  compute(value, { interval }) {\n    if (this.disableInterval) {\n      return;\n    }\n\n    this.clearTimer();\n\n    if (interval) {\n      /*\n       * NOTE: intentionally a setTimeout so tests do not block on it\n       * as the run loop queue is never clear so tests will stay locked waiting\n       * for queue to clear.\n       */\n      this.intervalTimer = setTimeout(\n        () => {\n          run(() => this.recompute());\n        },\n        parseInt(interval, 10),\n      );\n    }\n  }\n\n  morphLuxon(time, { locale, timeZone }) {\n    const luxonService = this.luxon;\n\n    locale = locale || luxonService.locale;\n    timeZone = timeZone || luxonService.timeZone;\n\n    if (locale && time.locale) {\n      time = time.setLocale(locale);\n    }\n\n    if (timeZone && time.tz) {\n      time = time.setZone(timeZone);\n    }\n\n    return time;\n  }\n\n  clearTimer() {\n    clearTimeout(this.intervalTimer);\n  }\n\n  willDestroy() {\n    this.clearTimer();\n    super.willDestroy(...arguments);\n  }\n}\n"],"names":["BaseHelper","Helper","g","this","prototype","service","i","void 0","tracked","globalAllowEmpty","luxon","__config__","allowEmpty","localeOrTimeZoneChanged","observer","recompute","compute","value","interval","disableInterval","clearTimer","intervalTimer","setTimeout","run","parseInt","morphLuxon","time","locale","timeZone","luxonService","setLocale","tz","setZone","clearTimeout","willDestroy","arguments"],"mappings":";;;;;;;AAOe,MAAMA,UAAU,SAASC,MAAM,CAAC;AAAA,EAAA;AAAAC,IAAAA,CAAA,CAAAC,IAAA,CAAAC,SAAA,YAC5CC,MAAO,CAAA,CAAA,CAAA;AAAA,GAAA;AAAA,EAAA,MAAA,IAAAC,CAAA,CAAAH,IAAA,YAAAI,KAAA,CAAA,EAAA;AAAA,EAAA;AAAAL,IAAAA,CAAA,CAAAC,IAAA,CAAAC,SAAA,sBAEPI,OAAO,CAAA,EAAA,YAAA;AAAA,MAAA,OAAmB,KAAK,CAAA;AAAA,KAAA,CAAA,CAAA;AAAA,GAAA;AAAA,EAAA,gBAAA,IAAAF,CAAA,CAAAH,IAAA,sBAAAI,KAAA,CAAA,EAAA;AAAA,EAAA;AAAAL,IAAAA,CAAA,CAAAC,IAAA,CAAAC,SAAA,+BAE/BI,OAAO,CAAA,EAAA,YAAA;AAAA,MAAA,OAA4B,IAAI,CAAA;AAAA,KAAA,CAAA,CAAA;AAAA,GAAA;AAAA,EAAA,yBAAA,IAAAF,CAAA,CAAAH,IAAA,+BAAAI,KAAA,CAAA,EAAA;EAExC,IAAIE,gBAAgBA,GAAG;AACrB,IAAA,OAAO,IAAI,CAACC,KAAK,CAACC,UAAU,CAACC,UAAU,CAAA;AACzC,GAAA;;AAEA;AACAC,EAAAA,uBAAuB,GAAGC,QAAQ,CAChC,cAAc,EACd,gBAAgB,EAChB,YAAY;IACV,IAAI,CAACC,SAAS,EAAE,CAAA;AAClB,GACF,CAAC,CAAA;EAEDC,OAAOA,CAACC,KAAK,EAAE;AAAEC,IAAAA,QAAAA;AAAS,GAAC,EAAE;IAC3B,IAAI,IAAI,CAACC,eAAe,EAAE;AACxB,MAAA,OAAA;AACF,KAAA;IAEA,IAAI,CAACC,UAAU,EAAE,CAAA;AAEjB,IAAA,IAAIF,QAAQ,EAAE;AACZ;AACN;AACA;AACA;AACA;AACM,MAAA,IAAI,CAACG,aAAa,GAAGC,UAAU,CAC7B,MAAM;AACJC,QAAAA,GAAG,CAAC,MAAM,IAAI,CAACR,SAAS,EAAE,CAAC,CAAA;AAC7B,OAAC,EACDS,QAAQ,CAACN,QAAQ,EAAE,EAAE,CACvB,CAAC,CAAA;AACH,KAAA;AACF,GAAA;EAEAO,UAAUA,CAACC,IAAI,EAAE;IAAEC,MAAM;AAAEC,IAAAA,QAAAA;AAAS,GAAC,EAAE;AACrC,IAAA,MAAMC,YAAY,GAAG,IAAI,CAACnB,KAAK,CAAA;AAE/BiB,IAAAA,MAAM,GAAGA,MAAM,IAAIE,YAAY,CAACF,MAAM,CAAA;AACtCC,IAAAA,QAAQ,GAAGA,QAAQ,IAAIC,YAAY,CAACD,QAAQ,CAAA;AAE5C,IAAA,IAAID,MAAM,IAAID,IAAI,CAACC,MAAM,EAAE;AACzBD,MAAAA,IAAI,GAAGA,IAAI,CAACI,SAAS,CAACH,MAAM,CAAC,CAAA;AAC/B,KAAA;AAEA,IAAA,IAAIC,QAAQ,IAAIF,IAAI,CAACK,EAAE,EAAE;AACvBL,MAAAA,IAAI,GAAGA,IAAI,CAACM,OAAO,CAACJ,QAAQ,CAAC,CAAA;AAC/B,KAAA;AAEA,IAAA,OAAOF,IAAI,CAAA;AACb,GAAA;AAEAN,EAAAA,UAAUA,GAAG;AACXa,IAAAA,YAAY,CAAC,IAAI,CAACZ,aAAa,CAAC,CAAA;AAClC,GAAA;AAEAa,EAAAA,WAAWA,GAAG;IACZ,IAAI,CAACd,UAAU,EAAE,CAAA;AACjB,IAAA,KAAK,CAACc,WAAW,CAAC,GAAGC,SAAS,CAAC,CAAA;AACjC,GAAA;AACF;;;;"}